function [ gammaTable1, firstFit, displayGamma, inputV] = fit_gamma()
%%
% Fits gamma table for data recorded by sonat and nwilming in April 2017 on
% nordic neuro lab screen.
measurements = [...
    0.0400    0.0300...
    0.2000    0.2200...
    0.6300    0.6600...
    2.0700    2.0600...
    5.0900    5.0200...
    8.2600    8.2000...
   12.5700   12.4700...
   17.7700   17.6800...
   23.2600   23.1500...
   30.5600   30.4100...
   39.0500   38.6600...
   47.6600   47.5800...
   58.4700   58.3200...
   69.7800   69.7800...
   81.2200   81.3200...
   95.1100   95.1900...
  110.3000  110.5000...
  124.6000  125.0000...
  141.0000  141.4000...
  159.0000  159.6000...
  176.7000  177.0000...
  198.4000  199.0000...
  220.2000  220.0000...
  239.2000  240.0000...
  262.4000  263.3000];

inputV = linspace(0, 1, length(measurements))';

vals = (measurements - min(measurements)) / range(measurements);

plot(inputV, vals)
hold on

%Gamma function fitting
g = fittype('x^g');
fittedmodel = fit(inputV, vals, g, 'StartPoint',1.5);
displayGamma = fittedmodel.g;

inputV = linspace(0, 1, 255)';
gammaTable1 = (((inputV))).^(1/fittedmodel.g); %#ok<NBRAK>
firstFit = fittedmodel(inputV); %#ok<NBRAK>
gammaTable1 = repmat(gammaTable1, 1, 3);
plot(inputV, firstFit, 'r')
end
